import{d as $,o as n,m as z,T as H,f as c,g as U,c as d,a as l,t as b,D as F,b as g,i as B,e as V,E as P,r as w,w as A,k as W,G as _,n as E,p as h,F as q,x as L,j as M,h as j,q as C,H as R,v as Y,I as N}from"./index-Dkm5N9GV.js";import{b as G}from"./Toast-1D9_cmOs.js";import{S as T,_ as O}from"./index-BwARp1s_.js";const J={class:"modal-header"},K={class:"modal-title"},Q={class:"modal-body"},X={key:0,class:"modal-footer"},Z=$({__name:"BaseModal",props:{visible:{type:Boolean},title:{},width:{default:"500px"}},emits:["close"],setup(s){return(i,r)=>(n(),z(H,{to:"body"},[c(P,{name:"modal"},{default:U(()=>[s.visible?(n(),d("div",{key:0,class:"modal-overlay",onClick:r[1]||(r[1]=V(m=>i.$emit("close"),["self"]))},[l("div",{class:"modal",style:B({maxWidth:s.width})},[l("div",J,[l("h3",K,b(s.title),1),l("button",{class:"modal-close",onClick:r[0]||(r[0]=m=>i.$emit("close"))},"×")]),l("div",Q,[F(i.$slots,"default",{},void 0,!0)]),i.$slots.footer?(n(),d("div",X,[F(i.$slots,"footer",{},void 0,!0)])):g("",!0)],4)])):g("",!0)]),_:3})]))}}),ye=G(Z,[["__scopeId","data-v-45b3648d"]]),ee={class:"status-text"},te=["onClick"],le=$({__name:"StatusSelect",props:{modelValue:{},workItemId:{},autosave:{type:Boolean},disabled:{type:Boolean},class:{}},emits:["update:modelValue","change","save"],setup(s,{emit:i}){const r=s,m=i,p=w(r.modelValue||"pending"),I=r.class||"",e=w(!1),f=w(null),v=M(()=>T[p.value]||T.pending),a=M(()=>v.value.label);A(()=>r.modelValue,u=>{u&&(p.value=u)});function t(){r.disabled||(e.value=!e.value)}function o(u){p.value=u,e.value=!1,m("update:modelValue",u),m("change",u),r.autosave!==!1&&r.workItemId&&m("save",{workItemId:r.workItemId,status:u})}function y(u){f.value&&!f.value.contains(u.target)&&(e.value=!1)}return W(()=>{document.addEventListener("click",y)}),_(()=>{document.removeEventListener("click",y)}),(u,x)=>(n(),d("div",{class:E(["status-select-wrapper",[h(I)]]),ref_key:"wrapperRef",ref:f},[l("div",{class:E(["status-tag cursor-pointer active:scale-95 transition-transform",[{"is-disabled":r.disabled}]]),style:B({backgroundColor:v.value.bgColor,color:v.value.color}),onClick:V(t,["stop"])},[l("span",ee,b(a.value),1),x[1]||(x[1]=l("span",{class:"ml-1 text-[10px] opacity-60"},"▼",-1))],6),e.value?(n(),d("div",{key:0,class:"status-dropdown",onClick:x[0]||(x[0]=V(()=>{},["stop"]))},[(n(!0),d(q,null,L(h(T),(S,D)=>(n(),d("div",{key:D,class:"status-option-item",onClick:fe=>o(D)},[l("span",{class:"status-option-tag",style:B({backgroundColor:S.bgColor,color:S.color})},b(S.label),5)],8,te))),128))])):g("",!0)],2))}}),ke=G(le,[["__scopeId","data-v-1a39eaa7"]]),ae={class:"space-y-1"},oe={key:0,class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},se={key:0,class:"text-red-500"},re=["type","value","placeholder","disabled"],ne={key:1,class:"text-sm text-red-500"},k=$({__name:"BaseInput",props:{modelValue:{},type:{default:"text"},label:{},placeholder:{},error:{},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s){return(i,r)=>(n(),d("div",ae,[s.label?(n(),d("label",oe,[j(b(s.label)+" ",1),s.required?(n(),d("span",se,"*")):g("",!0)])):g("",!0),l("input",{type:s.type,value:s.modelValue,placeholder:s.placeholder,disabled:s.disabled,class:E(["w-full px-3 py-2 rounded-lg border transition-colors",s.error?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary","focus:outline-none focus:ring-2 focus:ring-opacity-20","bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",{"bg-slate-50 dark:bg-slate-800 cursor-not-allowed":s.disabled}]),onInput:r[0]||(r[0]=m=>i.$emit("update:modelValue",m.target.value))},null,42,re),s.error?(n(),d("p",ne,b(s.error),1)):g("",!0)]))}}),de={class:"grid grid-cols-3 gap-4"},ie={class:"space-y-1"},ue={class:"space-y-1"},me=["value"],ce={class:"grid grid-cols-2 gap-4"},pe={class:"flex justify-end gap-3 pt-4"},xe=$({__name:"WorkItemForm",props:{workItem:{},loading:{type:Boolean},parentId:{}},emits:["submit","cancel"],setup(s,{emit:i}){const r=s,m=i,p=w(!!r.workItem);function I(){const a=new Date,t=o=>String(o).padStart(2,"0");return`${a.getFullYear()}-${t(a.getMonth()+1)}-${t(a.getDate())}T${t(a.getHours())}:${t(a.getMinutes())}`}const e=N({title:"",content:"",status:"pending",startTime:"",endTime:"",project:"",tag:"",type:"FEATURE"}),f=N({title:""});A(()=>r.workItem,a=>{a?(p.value=!0,e.title=a.title,e.content=a.content||"",e.status=a.status,e.startTime=a.startTime?a.startTime.slice(0,16):"",e.endTime=a.endTime?a.endTime.slice(0,16):"",e.project=a.project||"",e.tag=a.tag||"",e.type=a.type||"FEATURE"):(p.value=!1,e.title="",e.content="",e.status="pending",e.startTime=I(),e.endTime="",e.project="",e.tag="",e.type="FEATURE")},{immediate:!0});function v(){if(f.title="",!e.title.trim()){f.title="标题不能为空";return}const a={title:e.title.trim(),content:e.content.trim()||void 0,status:e.status,startTime:e.startTime?new Date(e.startTime).toISOString():void 0,endTime:e.endTime?new Date(e.endTime).toISOString():void 0,parentId:r.parentId,project:e.project.trim()||void 0,tag:e.tag.trim()||void 0,type:e.type};m("submit",a)}return(a,t)=>(n(),d("form",{onSubmit:V(v,["prevent"]),class:"space-y-4"},[l("div",de,[c(k,{modelValue:e.project,"onUpdate:modelValue":t[0]||(t[0]=o=>e.project=o),label:"项目",placeholder:"项目名称（可选）"},null,8,["modelValue"]),c(k,{modelValue:e.tag,"onUpdate:modelValue":t[1]||(t[1]=o=>e.tag=o),label:"标签",placeholder:"标签（可选）"},null,8,["modelValue"]),l("div",null,[t[10]||(t[10]=l("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"类型",-1)),C(l("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.type=o),class:"w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary focus:outline-none focus:ring-2 focus:ring-opacity-20 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"},[...t[9]||(t[9]=[l("option",{value:"FEATURE"},"功能",-1),l("option",{value:"BUG"},"缺陷",-1),l("option",{value:"SUPPORT"},"支持",-1)])],512),[[R,e.type]])])]),c(k,{modelValue:e.title,"onUpdate:modelValue":t[3]||(t[3]=o=>e.title=o),label:"标题",placeholder:"请输入工作项标题",required:"",error:f.title},null,8,["modelValue","error"]),l("div",ie,[t[11]||(t[11]=l("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"内容",-1)),C(l("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>e.content=o),placeholder:"请输入工作项内容",class:"w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary focus:outline-none focus:ring-2 focus:ring-opacity-20 min-h-[120px] bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"},null,512),[[Y,e.content]])]),l("div",ue,[t[12]||(t[12]=l("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"状态",-1)),C(l("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>e.status=o),class:"w-full px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 focus:border-primary focus:ring-primary focus:outline-none focus:ring-2 focus:ring-opacity-20 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"},[(n(!0),d(q,null,L(h(T),(o,y)=>(n(),d("option",{key:y,value:y},b(o.label),9,me))),128))],512),[[R,e.status]])]),l("div",ce,[c(k,{modelValue:e.startTime,"onUpdate:modelValue":t[6]||(t[6]=o=>e.startTime=o),type:"datetime-local",label:"开始时间"},null,8,["modelValue"]),c(k,{modelValue:e.endTime,"onUpdate:modelValue":t[7]||(t[7]=o=>e.endTime=o),type:"datetime-local",label:"结束时间"},null,8,["modelValue"])]),l("div",pe,[c(O,{variant:"secondary",type:"button",onClick:t[8]||(t[8]=o=>a.$emit("cancel"))},{default:U(()=>[...t[13]||(t[13]=[j(" 取消 ",-1)])]),_:1}),c(O,{type:"submit",loading:s.loading},{default:U(()=>[j(b(p.value?"保存":"创建"),1)]),_:1},8,["loading"])])],32))}});export{ye as B,ke as S,xe as _};
