import{d as j,r as y,w as J,k as F,o as r,c as l,a as t,t as d,F as Y,x as I,J as R,j as U,n as H,b as D,B as K,h as _,f as C,g as $,D as N,m as E,q as P,H as Q}from"./index-Dkm5N9GV.js";import{a as O,d as k,_ as X,u as Z,T as tt}from"./Toast-1D9_cmOs.js";function et(g){return O.get("/activity-logs",{params:g})}function st(g,b){return O.get("/activity-logs/calendar",{params:{year:g,month:b}})}const at={class:"bg-white dark:bg-slate-800 p-5 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700"},rt={class:"flex items-center justify-between mb-6"},ot={class:"text-lg font-bold text-slate-900 dark:text-white"},lt={class:"grid grid-cols-7 gap-1 text-center text-[10px] text-gray-400 dark:text-slate-500 font-bold mb-3 uppercase tracking-wider"},nt={class:"grid grid-cols-7 gap-2"},dt=["onClick"],it=j({__name:"Calendar",props:{dateCount:{},initialDate:{}},emits:["select-date","month-change"],setup(g,{emit:b}){const p=g,h=b,u=y(k().year()),a=y(k().month()+1),c=y(p.initialDate||null);J(()=>p.initialDate,o=>{c.value=o||null});const i=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"];function w(o){return o>=9?"bg-blue-600 !text-white":o>=4?"bg-blue-200":o>=1?"bg-blue-50":""}const n=U(()=>{var V,z,A;const o=k(`${u.value}-${a.value}-01`),m=o.daysInMonth(),e=o.day(),s=k().format("YYYY-MM-DD"),f=[],L=o.subtract(1,"month"),G=L.daysInMonth();for(let x=e-1;x>=0;x--){const v=G-x,M=L.date(v).format("YYYY-MM-DD");f.push({date:v,fullDate:M,isCurrentMonth:!1,isToday:M===s,isSelected:M===c.value,count:((V=p.dateCount)==null?void 0:V[M])||0})}for(let x=1;x<=m;x++){const v=o.date(x).format("YYYY-MM-DD");f.push({date:x,fullDate:v,isCurrentMonth:!0,isToday:v===s,isSelected:v===c.value,count:((z=p.dateCount)==null?void 0:z[v])||0})}const W=42-f.length,q=o.add(1,"month");for(let x=1;x<=W;x++){const v=q.date(x).format("YYYY-MM-DD");f.push({date:x,fullDate:v,isCurrentMonth:!1,isToday:v===s,isSelected:v===c.value,count:((A=p.dateCount)==null?void 0:A[v])||0})}return f});function S(){a.value===1?(u.value--,a.value=12):a.value--,h("month-change",u.value,a.value)}function T(){a.value===12?(u.value++,a.value=1):a.value++,h("month-change",u.value,a.value)}function B(o){o.isCurrentMonth&&(c.value=o.fullDate,h("select-date",o.fullDate))}return F(()=>{h("month-change",u.value,a.value)}),(o,m)=>(r(),l("div",at,[t("div",rt,[t("span",ot,d(u.value)+"å¹´ "+d(a.value)+"æœˆ",1),t("div",{class:"flex gap-1"},[t("button",{class:"p-1.5 hover:bg-gray-100 dark:hover:bg-slate-700 rounded text-gray-500 dark:text-slate-400 transition-colors",onClick:S},[...m[0]||(m[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("button",{class:"p-1.5 hover:bg-gray-100 dark:hover:bg-slate-700 rounded text-gray-500 dark:text-slate-400 transition-colors",onClick:T},[...m[1]||(m[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])])]),t("div",lt,[(r(),l(Y,null,I(i,e=>t("div",{key:e},d(e),1)),64))]),t("div",nt,[(r(!0),l(Y,null,I(n.value,(e,s)=>(r(),l("div",{key:s,class:H(["h-8 flex items-center justify-center text-xs rounded transition-all cursor-pointer select-none",e.isCurrentMonth?"hover:bg-blue-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300":"text-gray-300 dark:text-slate-600",e.isSelected?"bg-blue-600 text-white font-bold shadow-md ring-4 ring-blue-100 dark:ring-blue-900/50":e.isToday?"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300 font-medium":"",e.isCurrentMonth&&e.count>0&&!e.isSelected?w(e.count):""]),onClick:f=>B(e)},d(e.date),11,dt))),128))]),m[2]||(m[2]=R('<div class="mt-6 pt-4 border-t border-gray-50 dark:border-slate-700 space-y-2"><div class="flex items-center gap-2 text-[10px] text-gray-500 dark:text-slate-400 font-medium"><span class="w-3 h-3 bg-blue-50 dark:bg-blue-900/30 rounded-sm"></span><span>å°‘é‡è®°å½• (1-3)</span></div><div class="flex items-center gap-2 text-[10px] text-gray-500 dark:text-slate-400 font-medium"><span class="w-3 h-3 bg-blue-200 dark:bg-blue-800/50 rounded-sm"></span><span>ä¸­ç­‰è®°å½• (4-8)</span></div><div class="flex items-center gap-2 text-[10px] text-gray-500 dark:text-slate-400 font-medium"><span class="w-3 h-3 bg-blue-600 rounded-sm"></span><span>å¤§é‡è®°å½• (9+)</span></div></div>',1))]))}}),ut={class:"relative px-2 py-4"},ct={class:"space-y-10"},xt={class:"w-10 text-right text-xs text-gray-400 dark:text-slate-500 pt-2 shrink-0 font-medium"},gt={class:"text-[10px]"},pt={class:"flex-1 min-w-0"},vt={class:"flex items-center gap-2 mb-1.5"},bt={class:"text-sm font-bold text-gray-900 dark:text-white leading-none"},mt={class:"text-sm text-gray-600 dark:text-slate-400 leading-relaxed"},ft={key:1,class:"mt-2 bg-gray-50 dark:bg-slate-700 border border-gray-100 dark:border-slate-600 p-4 rounded-lg text-sm text-gray-600 dark:text-slate-300 italic shadow-sm"},kt={key:2,class:"mt-1"},ht={class:"mt-2 text-[10px] text-gray-400 dark:text-slate-500 font-medium flex items-center gap-2"},yt={key:0,class:"text-center py-16"},wt=j({__name:"ActivityLogList",props:{logs:{}},setup(g){const b={create:"â•",update:"âœï¸",status:"ğŸ”„",comment:"ğŸ’¬",delete:"ğŸ—‘ï¸",restore:"â™»ï¸"},p={create:"åˆ›å»ºè®°å½•",update:"ä¿¡æ¯æ›´æ–°",status:"çŠ¶æ€å˜æ›´",comment:"æ·»åŠ å¤‡æ³¨",delete:"ç§»è‡³å›æ”¶ç«™",restore:"è®°å½•æ¢å¤"},h={create:"bg-yellow-100 text-yellow-600",update:"bg-blue-100 text-blue-600",status:"bg-green-100 text-green-600",comment:"bg-purple-100 text-purple-600",delete:"bg-red-100 text-red-600",restore:"bg-teal-100 text-teal-600"};function u(c){return k(c).format("YYYY-MM-DD HH:mm:ss")}function a(c){return k(c).format("HH:mm")}return(c,i)=>{const w=K("router-link");return r(),l("div",ut,[i[3]||(i[3]=t("div",{class:"absolute left-[3.25rem] top-8 bottom-8 w-0.5 bg-gray-100 dark:bg-slate-700"},null,-1)),t("div",ct,[(r(!0),l(Y,null,I(g.logs,n=>(r(),l("div",{key:n.id,class:"relative flex gap-8"},[t("div",xt,d(a(n.createdAt)),1),t("div",{class:H(["flex-shrink-0 w-8 h-8 rounded-full border-4 border-white dark:border-slate-800 shadow-sm z-10 flex items-center justify-center transition-transform hover:scale-110",h[n.type]])},[t("span",gt,d(b[n.type]),1)],2),t("div",pt,[t("div",vt,[t("h5",bt,d(p[n.type]),1)]),t("div",mt,[n.workItem?(r(),l(Y,{key:0},[i[0]||(i[0]=_(" å·¥ä½œé¡¹ ",-1)),C(w,{to:`/work-item/${n.workItem.id}`,class:"text-blue-600 dark:text-blue-400 hover:underline font-medium"},{default:$(()=>[_(" ã€Œ"+d(n.workItem.title)+"ã€ ",1)]),_:2},1032,["to"])],64)):D("",!0),n.type==="comment"?(r(),l("div",ft,' "'+d(n.description)+'" ',1)):(r(),l("p",kt,d(n.description),1))]),t("div",ht,[i[1]||(i[1]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),_(" "+d(u(n.createdAt)),1)])])]))),128)),g.logs.length===0?(r(),l("div",yt,[...i[2]||(i[2]=[t("div",{class:"w-16 h-16 bg-gray-50 dark:bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-4"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-300 dark:text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1),t("p",{class:"text-gray-400 dark:text-slate-500 text-sm"},"æ­¤æ—¥æœŸä¸‹æš‚æ— æ´»åŠ¨è®°å½•",-1)])])):D("",!0)])])}}}),_t={class:"bg-white dark:bg-slate-800 p-5 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700"},Dt={key:0,class:"font-bold text-sm mb-4 flex items-center gap-2 text-gray-900 dark:text-white"},Mt=j({__name:"SidebarCard",props:{title:{}},setup(g){return(b,p)=>(r(),l("div",_t,[g.title?(r(),l("h4",Dt,[N(b.$slots,"icon"),_(" "+d(g.title),1)])):D("",!0),N(b.$slots,"default")]))}}),Ct={class:"max-w-7xl mx-auto flex gap-8"},$t={class:"w-80 space-y-6 shrink-0"},Yt={class:"space-y-5"},jt={key:0,class:"pt-4 border-t border-gray-50 dark:border-slate-700"},St={class:"flex-1 min-w-0"},Tt={class:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 overflow-hidden flex flex-col min-h-[600px]"},Bt={class:"p-6 bg-gray-50/80 dark:bg-slate-700/50 border-b border-gray-100 dark:border-slate-700 flex items-center justify-between backdrop-blur-sm sticky top-0 z-10"},It={class:"flex items-center gap-4"},Lt={key:0,class:"text-4xl font-black text-blue-600 tracking-tighter"},Vt={key:1,class:"w-12 h-12 bg-blue-100 dark:bg-blue-900/50 rounded-xl flex items-center justify-center"},zt={class:"font-bold text-lg text-gray-900 dark:text-white leading-tight"},At={class:"text-[10px] text-gray-400 dark:text-slate-500 uppercase tracking-[0.2em] font-bold mt-0.5"},Nt={class:"text-right hidden sm:block"},Et={class:"text-sm font-bold text-gray-900 dark:text-white"},Ft={class:"p-8 flex-1"},Ht={key:0,class:"flex flex-col items-center justify-center py-20"},Ot={key:0,class:"p-6 bg-gray-50/30 dark:bg-slate-700/30 border-t border-gray-50 dark:border-slate-700 flex justify-center mt-auto"},qt=j({__name:"DailyLog",setup(g){k.locale("zh-cn");const b=Z(),p=y([]),h=y({}),u=y(!1),a=y(null),c=y("");F(async()=>{await i()});async function i(){u.value=!0;try{p.value=await et({date:a.value||void 0,type:c.value||void 0})}catch(e){b.error(e.message||"åŠ è½½å¤±è´¥")}finally{u.value=!1}}async function w(e,s){try{h.value=await st(e,s)}catch(f){console.error("Failed to load calendar data:",f)}}function n(e){a.value=e,i()}function S(e,s){w(e,s)}function T(){a.value=null,i()}function B(e){return k(e).format("DD")}function o(e){return k(e).format("YYYYå¹´ Mæœˆ Dæ—¥")}function m(e){return k(e).format("dddd")}return(e,s)=>(r(),E(X,{title:"æŒ‰å¤©æ—¥å¿—æŸ¥çœ‹"},{default:$(()=>[t("div",Ct,[t("div",$t,[C(it,{"date-count":h.value,"initial-date":a.value,onSelectDate:n,onMonthChange:S},null,8,["date-count","initial-date"]),C(Mt,{title:"æ—¥å¿—ç­›é€‰"},{icon:$(()=>[...s[1]||(s[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)])]),default:$(()=>[t("div",Yt,[t("div",null,[s[3]||(s[3]=t("label",{class:"text-[10px] text-gray-400 dark:text-slate-500 block mb-2 uppercase tracking-[0.1em] font-bold"},"æŒ‰ç±»å‹æŸ¥çœ‹",-1)),P(t("select",{"onUpdate:modelValue":s[0]||(s[0]=f=>c.value=f),class:"w-full text-sm border-gray-200 dark:border-slate-600 rounded-lg focus:border-blue-500 focus:ring-blue-500 transition-all px-3 py-2 bg-gray-50/50 dark:bg-slate-700 outline-none text-slate-900 dark:text-slate-100",onChange:i},[...s[2]||(s[2]=[t("option",{value:""},"æ˜¾ç¤ºå…¨éƒ¨",-1),t("option",{value:"create"},"åˆ›å»ºè®°å½•",-1),t("option",{value:"update"},"ä¿¡æ¯æ›´æ–°",-1),t("option",{value:"status"},"çŠ¶æ€å˜æ›´",-1),t("option",{value:"comment"},"æ·»åŠ å¤‡æ³¨",-1),t("option",{value:"delete"},"ç§»è‡³å›æ”¶ç«™",-1),t("option",{value:"restore"},"è®°å½•æ¢å¤",-1)])],544),[[Q,c.value]])]),a.value?(r(),l("div",jt,[t("button",{class:"text-[10px] font-bold text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors uppercase tracking-widest flex items-center justify-center gap-2 w-full py-2.5 hover:bg-blue-50 dark:hover:bg-slate-700 rounded-lg border border-transparent hover:border-blue-100 dark:hover:border-slate-600",onClick:T},[...s[4]||(s[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),_(" æ¸…é™¤æ—¥æœŸç­›é€‰ ",-1)])])])):D("",!0)])]),_:1})]),t("div",St,[t("div",Tt,[t("div",Bt,[t("div",It,[a.value?(r(),l("div",Lt,d(B(a.value)),1)):(r(),l("div",Vt,[...s[5]||(s[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])])),t("div",null,[t("div",zt,d(a.value?o(a.value):"è¿‘æœŸæ´»åŠ¨"),1),t("div",At,d(a.value?m(a.value):"ACTIVITY FEED"),1)])]),t("div",Nt,[t("div",Et,d(p.value.length)+" æ¡è®°å½•",1),s[6]||(s[6]=t("div",{class:"text-[10px] text-gray-400 dark:text-slate-500 uppercase tracking-wider font-bold"},"LOG ENTRIES",-1))])]),t("div",Ft,[u.value?(r(),l("div",Ht,[...s[7]||(s[7]=[t("div",{class:"w-10 h-10 border-4 border-blue-50 dark:border-slate-600 border-t-blue-600 rounded-full animate-spin mb-4"},null,-1),t("p",{class:"text-gray-400 dark:text-slate-500 text-xs font-bold uppercase tracking-widest"},"LOADING LOGS",-1)])])):(r(),E(wt,{key:1,logs:p.value},null,8,["logs"]))]),a.value&&!u.value?(r(),l("div",Ot,[...s[8]||(s[8]=[t("span",{class:"text-[10px] text-gray-400 dark:text-slate-500 font-bold uppercase tracking-[0.3em]"},"END OF DAY",-1)])])):D("",!0)])])]),C(tt)]),_:1}))}});export{qt as default};
